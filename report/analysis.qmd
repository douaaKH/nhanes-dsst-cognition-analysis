---
title: "nhanes-dsst-congition-analysis"
author: "Douaa Khalil"
format: html
bibliography: references.bib
editor: visual
---

```{=html}
<style>
p {
  text-align: justify;
}
</style>
```
```{r}
#| include: false
trunc2 <- function(x) {
  ifelse(is.na(x), NA, floor(x * 100) / 100)
}
```

## Research Question and Introduction

### Research Question

What factors are associated with cognitive functioning among adults aged 60 years and older in the United States?

### Introduction

Cognitive functioning is a key component of healthy aging and is closely linked to independence, quality of life, and overall well-being among older adults. Declines in cognitive performance are associated with increased risk of disability, institutionalization, and mortality, making the identification of factors related to cognitive health a public health priority [@rivan2021cognitive].

Cognitive functioning in later life is influenced by a complex interplay of demographic, socioeconomic, behavioral, physical, and mental health factors. The goal of this analysis is to explore associations between cognitive performance and a broad set of variables among U.S. adults aged 60 years and older, using data from a nationally representative health survey. This report is **exploratory and iterative in nature** and will be updated as the project progresses.

::: callout-note
This is a preliminary and evolving analysis. The literature review is not intended to be exhaustive, and modeling decisions (including weighting and missing data handling) will be refined in future versions.
:::

## Data Source and Sample

### Data Source

Data for this analysis come from the [**National Health and Nutrition Examination Survey (NHANES) 2013–2014 cycle**](https://wwwn.cdc.gov/nchs/nhanes/continuousnhanes/default.aspx?BeginYear=2013), a cross-sectional survey designed to assess the health and nutritional status of the non-institutionalized U.S. population.

### Study Sample

The analytic sample includes **adults aged 60 years and older** who participated in the cognitive function component of NHANES. The working dataset contains 1785 participants.

At this stage, analyses are conducted on the unweighted sample. **Survey weights will be incorporated in later modeling stages** to produce population-representative estimates and to appropriately account for the complex survey design.

## Outcome: Cognitive Function

### Digit Symbol Substitution Test

Cognitive functioning is assessed using the **Digit Symbol Substitution Test (DSST)**, a widely used neuropsychological test administered in NHANES as part of the cognitive function examination for older adults [@jaeger2018digit].

The DSST measures general cognitive performance, such as:

-   Processing speed

-   Sustained attention

-   Working memory

Participants are asked to match symbols to numbers according to a key within a fixed time limit. The final score reflects the **number of correct matches**, with higher scores indicating better cognitive performance.

In NHANES 2013–2014, DSST scores range from **0 to 133**, with observed scores in this sample spanning a narrower range typical of older populations. The DSST is particularly sensitive to age-related cognitive changes and has been shown to predict functional decline and mortality in older adults [@rosano2008association].

## Candidate Predictors and Related Literature

A broad set of variables were selected based on prior evidence linking demographic characteristics, lifestyle behaviors, health, and chronic conditions to cognitive function. The literature review guiding variable selection is **intentionally brief and non-exhaustive**, serving primarily to motivate exploratory analysis.

### Demographic and Socioeconomic Factors

-   Age [@salthouse2010]

-   Gender [@mcCarrey2016]

-   Marital status [@fratiglioni2004]

-   Educational attainment [@stern2012]

-   Income-to-poverty ratio [@jefferson2011life]

### Lifestyle Behaviors

-   Alcohol consumption [@anstey2009alcohol]

-   Smoking status [@peters2008smoking]

-   Physical activity / recreational activity [@erickson2011]

-   Sleep duration [@yaffe2014connections]

-   Diet quality (self-reported) [@arikawa2025cognitive]

### Physical and Cardiometabolic Health

-   Body mass index (BMI) [@fitzpatrick2009]

-   Blood pressure / hypertension indicators [@iadecola2016]

-   Diabetes status [@biessels2006]

-   Cardiovascular conditions [@gorelick2011]

### Mental and Neurological Health

-   Depressive symptoms (PHQ-9 score) [@ganguli2006depressive]

-   History of stroke [@pendlebury2009]

These variables were drawn from NHANES **Demographic**, **Questionnaire**, and **Examination** components.

## Data Merging

Data from multiple NHANES components were merged using the unique participant identifier (`SEQN`). Outcome: DSST (`CFDDS` in NHANES).

### Variable Selection

| Predictor                                                | Variable(s) in NHANES                                      | Description                                                                                                                                                                                                                                                                                                                           |
|--------------------|---------------------|-------------------------------|
| Age                                                      | `RIDAGEYR`                                                 | Direct measure, continuous.                                                                                                                                                                                                                                                                                                           |
| Gender                                                   | `RIAGENDR`                                                 | Direct measure, categorical, nominal.                                                                                                                                                                                                                                                                                                 |
| Marital status                                           | `DMDMARTL`                                                 | Comprehensive categorical measure, nominal.                                                                                                                                                                                                                                                                                           |
| Education level                                          | `DMDEDUC2`                                                 | Highest Degree, categorical, ordinal.                                                                                                                                                                                                                                                                                                 |
| Income-to-poverty ratio                                  | `INDFMMPI`                                                 | Monthly family poverty index, accounts for household size and income, continuous.                                                                                                                                                                                                                                                     |
| Alcohol drinks per week                                  | `ALQ120Q`, `ALQ120U`                                       | Derived from total drinks/week-month-year in the past year, continuous.                                                                                                                                                                                                                                                               |
| Current smoking status                                   | `SMQ040`                                                   | "Do you now smoke cigarettes", categorical, ordinal ("Not at all", "Some days", "Every day").                                                                                                                                                                                                                                         |
| Diet quality                                             | `DBQ700`                                                   | “How healthy is your diet”, a self-rated measure ranging from poor to excellent. This variable was selected as a parsimonious indicator of overall dietary quality, avoiding the complexity of detailed nutrient intake variables. Categorical, ordinal.                                                                              |
| Physical (recreational) activity, total minutes per week | `PAQ650`, `PAQ655`, `PAD660`, `PAQ665`, `PAQ670`, `PAD675` | Derived. Physical activity was operationalized using recreational moderate and vigorous activities. Recreational activity was preferred over work-related and transportation-related physical activity variables, as they are the most relevant indicator of intentional physical engagement. Continuous.                             |
| Sleep Duration                                           | `SLD010H`                                                  | How much sleep do you get (hours), continuous.                                                                                                                                                                                                                                                                                        |
| Body mass index                                          | `BMXBMI`                                                   | Body Mass Index, continuous.                                                                                                                                                                                                                                                                                                          |
| Diabetes                                                 | `DIQ010`                                                   | “Doctor told you have diabetes”, a self-reported physician diagnosis. This measure was preferred over laboratory biomarkers to ensure consistency with other self-reported health conditions and to reflect clinically recognized disease status. Categorical, nominal.                                                               |
| Cardiovascular/Coronary heart disease                    | `MCQ160C`                                                  | "Ever told you had coronary heart disease", self-reported physician diagnosis used to identify history of coronary cardiovascular disease. Categorical, nominal.                                                                                                                                                                      |
| Hypertension evidence                                    | `BPQ020`, `BPXSY*`*,* `BPXDI*`                             | Hypertension was expressed using a composite indicator (“hypertension_evidence”) combining self-reported prior diagnosis and measured blood pressure values collected during the examination. This approach aimed to capture both diagnosed hypertension and undiagnosed but currently elevated blood pressure. Categorical, nominal. |
| Stroke                                                   | `MCQ160F`                                                  | "Ever told you had stroke", self-reported physician diagnosis used to identify history of stroke. Categorical, nominal.                                                                                                                                                                                                               |
| Depressive symptoms                                      | `DPQ010`:`DPQ090`                                          | PHQ-9 questions: nine-item depression screening instrument, determining the frequency of depression symptoms over the past 2 weeks. Continuous.                                                                                                                                                                                       |

These variable selections reflect a balance between conceptual relevance and interpretability. Given the exploratory nature of this analysis, parsimonious representations were prioritized over highly granular measures.

For chronic conditions such as diabetes, hypertension, cardiovascular disease, and stroke, indicators are based primarily on self-reported physician diagnoses and/or examination-based measures. Two limitations should be noted. First, undiagnosed disease may lead to misclassification, particularly for conditions that can remain asymptomatic. Second, effective treatment may result in individuals with diagnosed conditions exhibiting cognitive functioning comparable to those without the condition at the time of assessment. These factors may attenuate associations and should be considered when interpreting results.

Here are some examples of the merged data:

```{r}
#| label: load-data
#| echo: false
#| message: false
#| warning: false
#| cache: true

source("../scripts/data_merge.R")  # this script creates my_data
```

```{r}
#| echo: false
#| warning: false

library(knitr)

kable(
  head(my_data, 5),
  caption = "First 5 rows of the merged dataset",
  align = "c"  # all centered
)

```

<br>

Overall, there are `r nrow(my_data)` rows and `r ncol(my_data)` columns (including `SEQN)`.

Missing data (NA) will be addressed in the subsequent section.

## Missing Data

```{r}
#| label: missing-data
#| echo: false
#| results: 'hide'
#| message: false
#| warning: false
#| cache: false

source("../scripts/data_missing.R")  # this script recode some values as NA
```

First, let's take a look at how many missing values are per variable:

```{r}
#| echo: false
#| warning: false

library(dplyr)
library(knitr)

# Compute missing count per column
missing_count <- colSums(is.na(my_data))

# Compute missing percentage per column
missing_pct <- round(missing_count / nrow(my_data) * 100, 1)

# Combine into a compact table: variables as columns
missing_table <- rbind(
  Count = missing_count,
  Percent = missing_pct
)

# Display nicely
kable(missing_table, caption = "Missing values per variable (Count and %)",     align = "c"  # all centered
)
```

<br>

In total, there are `r sum(!complete.cases(my_data))` or around `r format(round(sum(!complete.cases(my_data)) / nrow(my_data) * 100, 2), nsmall = 2)`% incomplete rows.

Some variables include rare responses (e.g., “Refused” or “Don’t know”), which have been recoded as NA to simplify modeling and avoid inflating the number of levels with very few observations. This procedure slightly increased overall missingness for certain predictors. Notably:

-   **Marital status:** 100% of missing values (n = 2) correspond to “Refused” and “Don’t know” responses.

-   **Education level:** 100% of missing values (n = 3) correspond to “Don’t know.”

-   **Sleep hours:** 40% of missing values (n = 2) correspond to “Don’t know.”

-   **Healthy diet:** 100% of missing values (n = 1) correspond to “Don’t know.”

-   **Diabetes:** 100% of missing values (n = 1) correspond to “Don’t know.”

-   **Coronary disease:** 100% of missing values (n = 12) correspond to “Don’t know.”

-   **Stroke:** 100% of missing values (n = 4) correspond to “Don’t know.”

Several variables exhibit higher overall levels of missingness and warrant further investigation, including **smoking status** (`r format(missing_pct[9], nsmall = 2)`% missing), **income-to-poverty ratio** (`r format(missing_pct[7], nsmall = 2)`%), **alcohol consumption** (`r format(missing_pct[8], nsmall = 2)`%), **PHQ-9 score** (`r format(missing_pct[16], nsmall = 2)`% total missing; among these, 12.58% reflect partial questionnaire completion and were recoded as missing), and **BMI** (`r format(missing_pct[12], nsmall = 2)`%).

The outcome variable, **DSST score**, has approximately `r format(missing_pct[2], nsmall = 2)`% missing values. Importantly, the NHANES survey provides explicit reasons for non-administration of the DSST (check `CFDDPP`, `CFDDRNC`, and `CFASTAT` variables in NHANES), allowing for a more informed assessment of outcome missingness.

```{r}
#| label: fig-dsst-reasons-missing
#| echo: false
#| warning: false

library(dplyr)
library(ggplot2)

dsst_na <- cfq_h %>%
  filter(is.na(CFDDS)) %>%
  mutate(
    DSST_NA_reason = case_when(
      CFDDPP == "Failed"   ~ "Pretest failed",
      CFDDPP == "Not done" & !is.na(CFDDRNC) ~ paste("Not done:", CFDDRNC),
      is.na(CFDDPP) & !is.na(CFASTAT)        ~ paste("Not done:", CFASTAT),
      TRUE ~ "Other"
    )
  )

dsst_na_counts <- dsst_na %>%
  count(DSST_NA_reason, sort = TRUE)

dsst_na_counts <- dsst_na_counts %>%
  mutate(pct = n / sum(n) * 100)

ggplot(dsst_na_counts,
       aes(x = reorder(DSST_NA_reason, pct), y = pct)) +
  geom_col() +
  geom_text(
    aes(label = paste0(n, " (", sprintf("%.1f", pct), "%)")),
    hjust = -0.1,
    size = 3.5
  ) +
  coord_flip() +
  labs(
    title = "Reasons for Missing DSST Scores",
    x = NULL,
    y = "Percentage of missing DSST"
  ) +
  theme_minimal() +
  expand_limits(y = max(dsst_na_counts$pct) * 1.2)
```

@fig-dsst-reasons-missing displays the distribution of reasons for missing DSST scores.

<!--# Some variables with many categories (such as education, marital status, diet, and others) will be examined and, if necessary, collapsed into fewer levels to facilitate interpretation. -->

## Exploratory Data Analysis (EDA)

## Statistical Modeling

## Limitations

## Conclusion

## References
